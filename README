updated to use secrets part 2